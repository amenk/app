<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/iron-input/iron-input.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../common/shared-styles.html">

<dom-module id="search-bar">
    <template>
        <style include="shared-styles"></style>
        <style>
            :host {
                align-items: center;
                background-color: #fafafa;
                border-radius: 2px;
                box-shadow: 0 0 2px 0 rgba(0,0,0,0.12), 0 2px 2px 0 rgba(0,0,0,0.24);
                display: flex;
                height: 48px;
                position: relative;
            }

            paper-icon-button {
                color: black;
                flex-shrink: 0;
                margin: 0 4px;
                padding: 8px;

                --iron-icon-height: 24px;
                --iron-icon-width: 24px;
            }

            input {
                background: transparent;
                border: 0;
                color: black;
                font-size: 16px;
                height: 100%;
                line-height: 24px;
                margin: 0 16px 0 0;
                width: 100%;
            }

            input:focus {
                outline: none;
            }

            input::-webkit-input-placeholder {
                color: rgba(0, 0, 0, .54);
            }
        </style>

        <paper-icon-button icon="[[_getIcon(value)]]" on-tap="_tapIconButton"></paper-icon-button>
        <input is="iron-input" bind-value="{{value}}" placeholder="[[placeholder]]">
    </template>
    <script>
        Polymer({
            is: 'search-bar',

            properties: {
                placeholder: {
                    type: String
                },
                value: {
                    type: String,
                    notify: true
                }
            },

            _getIcon: function (input) {
                return (typeof input == 'string' && input.length > 0) ?
                    'arrow-back' :
                    'festify:logo';
            },

            _tapIconButton: function () {
                const input = this.value;
                if (input && input.length > 0) {
                    this.set('value', null);
                }
            }
        });
    </script>
</dom-module>
